<!DOCTYPE html>
<meta charset='UTF-8'>
<title>VAW Concertina</title>

<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/4.0.0/normalize.min.css' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed' rel='stylesheet' type='text/css'>

<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.min.js'></script>

<script src='lib/tabletop.js'></script>

<link href='styles.css' rel='stylesheet' type='text/css'>
<script src='timeline.js'></script>
<script src='icons.js'></script>

<div id='header'><img src='images/tackling_violence_roundel.jpg'/></div>

<div id='icons'></div>

<div id='timeline' class='accordion'></div>

<script>
  var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/12m1zaJVgUwJj3-F19XFAWnyWzbaRHdC3SB-ARDRpf4k/pubhtml';

  // load data
  Tabletop.init( { key: public_spreadsheet_url,
                   callback: visualize,
                   simpleSheet: true })

  // generate timeline
  function visualize(data) {
    type(data)

    icons( $('#icons')[0], data)

    timeline( $('#timeline')[0], data, function() {

      // pause on load; then start closed
      $('.period ul').delay(500).slideUp()

      // accordion effect
      $('.period h2').click( function() {
        $(this).next().slideToggle()
      })

    })
  }

  // convert ajax data file to javascript types
  function type(data) {
    data.forEach(function(d) {
      d.year = +d.year
    })
  }
</script>
